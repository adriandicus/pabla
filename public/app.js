!function(){"use strict";var e="undefined"==typeof window?global:window;if("function"!=typeof e.require){var t={},i={},r={},n={}.hasOwnProperty,s=/^\.\.?(\/|$)/,a=function(e,t){for(var i,r=[],n=(s.test(t)?e+"/"+t:t).split("/"),a=0,o=n.length;o>a;a++)i=n[a],".."===i?r.pop():"."!==i&&""!==i&&r.push(i);return r.join("/")},o=function(e){return e.split("/").slice(0,-1).join("/")},u=function(t){return function(i){var r=a(o(t),i);return e.require(r,t)}},l=function(e,t){var r={id:e,exports:{}};return i[e]=r,t(r.exports,u(e),r),r.exports},c=function(e){return r[e]?c(r[e]):e},h=function(e,r){null==r&&(r="/");var s=c(e);if(n.call(i,s))return i[s].exports;if(n.call(t,s))return l(s,t[s]);throw new Error("Cannot find module '"+e+"' from '"+r+"'")};h.alias=function(e,t){r[t]=e},h.reset=function(){t={},i={},r={}};var d=/\.[^.\/]+$/,f=/\/index(\.[^\/]+)?$/,m=function(e){if(d.test(e)){var t=e.replace(d,"");n.call(r,t)&&r[t].replace(d,"")!==t+"/index"||(r[t]=e)}if(f.test(e)){var i=e.replace(f,"");n.call(r,i)||(r[i]=e)}};h.register=h.define=function(e,r){if("object"==typeof e)for(var s in e)n.call(e,s)&&h.register(s,e[s]);else t[e]=r,delete i[e],m(e)},h.list=function(){var e=[];for(var i in t)n.call(t,i)&&e.push(i);return e},h.brunch=!0,h._cache=i,e.require=h}}(),require.register("components/App.jsx",function(e,t,i){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(e,"__esModule",{value:!0});var n=t("react"),s=r(n),a=t("./ImageCanvas"),o=r(a),u=t("./ImagePicker"),l=r(u),c=t("./Card"),h=r(c),d=[{url:"https://images.unsplash.com/photo-1458640904116-093b74971de9?fm=jpg"},{url:"https://images.unsplash.com/photo-1453227588063-bb302b62f50b?fm=jpg"},{url:"https://images.unsplash.com/photo-1451906278231-17b8ff0a8880?fm=jpg"},{url:"https://images.unsplash.com/photo-1447969025943-8219c41ea47a?fm=jpg"},{url:"https://images.unsplash.com/photo-1421749810611-438cc492b581?fm=jpg"},{url:"https://images.unsplash.com/photo-1449960238630-7e720e630019?fm=jpg"},{url:"https://images.unsplash.com/photo-1433190152045-5a94184895da?fm=jpg"}];e["default"]=s["default"].createClass({displayName:"App",getInitialState:function(){return{selected:d[0],fontSize:32,contrast:!0}},handleSelect:function(e){this.setState({selected:e})},updateFontSize:function(){this.setState({fontSize:parseInt(this.refs.fontSize.value,10)})},updateContrast:function(){this.setState({contrast:this.refs.contrast.checked})},handleDownload:function(e){var t=this.state.imageDataURL,i=e.target;i.href=t,i.click()},updateDrawnImage:function(e){this.state.imageDataURL!==e&&this.setState({imageDataURL:e})},render:function(){return s["default"].createElement("div",{className:"Container"},s["default"].createElement("div",{className:"Sidebar"},s["default"].createElement(h["default"],{title:"Images"},s["default"].createElement(l["default"],{images:d,selected:this.state.selected,onSelect:this.handleSelect}))),s["default"].createElement("div",{className:"Main"},s["default"].createElement(o["default"],{image:this.state.selected,fontSize:this.state.fontSize,contrast:this.state.contrast,onRedraw:this.updateDrawnImage})),s["default"].createElement("div",{className:"Sidebar"},s["default"].createElement(h["default"],{title:"Sizes"},"To be implemented."),s["default"].createElement(h["default"],{title:"Filters"},s["default"].createElement("label",null,s["default"].createElement("input",{ref:"contrast",checked:this.state.contrast,type:"checkbox",onChange:this.updateContrast})," Contrast")),s["default"].createElement(h["default"],{title:"Text"},"Font size:",s["default"].createElement("select",{ref:"fontSize",value:this.state.fontSize,onChange:this.updateFontSize},[8,10,12,14,16,18,20,22,26,32,36,42,48,54].map(function(e){return s["default"].createElement("option",{value:e},e)}))),s["default"].createElement("div",null,s["default"].createElement("a",{className:"Button",download:"pabla.jpg",target:"_blank",onClick:this.handleDownload},"Download"))))}})}),require.register("components/Card.jsx",function(e,t,i){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(e,"__esModule",{value:!0});var n=t("react"),s=r(n);e["default"]=function(e){var t=e.title,i=e.children;return s["default"].createElement("div",{className:"Card"},s["default"].createElement("div",{className:"Card-header"},s["default"].createElement("h4",null,t)),i)}}),require.register("components/ImageCanvas.jsx",function(e,t,i){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function n(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function e(e,t){var i=[],r=!0,n=!1,s=void 0;try{for(var a,o=e[Symbol.iterator]();!(r=(a=o.next()).done)&&(i.push(a.value),!t||i.length!==t);r=!0);}catch(u){n=!0,s=u}finally{try{!r&&o["return"]&&o["return"]()}finally{if(n)throw s}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=t("react"),o=r(a),u={8:"backspace",27:"escape",37:"arr_left",39:"arr_right"},l=500,c=l-40-10,h=function(e,t){var i=t.getBoundingClientRect(),r={x:e.clientX-i.left,y:e.clientY-i.top};return r},d=function(e,t){return e.x>=t[0]&&e.x<=t[0]+t[2]&&e.y>=t[1]&&e.y<=t[1]+t[3]},f=function(e){var t=e.getContext("2d");if(window.devicePixelRatio){var i=e.width,r=e.height;e.width=i*window.devicePixelRatio,e.height=r*window.devicePixelRatio,window.c=e,e.style.width=i+"px",e.style.height=r+"px",t.scale(window.devicePixelRatio,window.devicePixelRatio)}},m=function(e,t){e.fillStyle="rgba(45, 45, 45, 0.45)",e.fillRect(0,0,t,t)},p=function(e,t,i){var r=i.naturalWidth,n=i.naturalHeight,s=r>n?n:r,a=n>r?n:r,o=s;e.drawImage(i,(a-s)/2,0,o,o,0,0,t,t)},v=function(e,t,i){var r=i.split(" "),n=[""],s=[[]],a=0;return r.forEach(function(i,r){var o=n.length-1,u=n[o],l=0===u.length?i:u+" "+i;if(e.measureText(l).width<=t||0===u.length){n[o]=l;0===u.length;s[o]=s[o].concat(i.split("").map(function(e,t){return a+1+t}))}else s.push(i.split("").map(function(e,t){return a+1+t})),n.push(i);s[n.length-1].push(a+1+i.length),a=a+1+i.length}),[n,s]},g=function(e,t,i,r,n){e.font=r+"px Georgia",e.fillStyle="white";var a=c,o=v(e,a,n),u=s(o,2),l=u[0],h=(u[1],1.3*r),d=void 0;return l.forEach(function(s,a){var o=t[0]+10,u=t[1]+r+a*h;i&&i.y<=u&&i.y>=u-h&&s.split("").forEach(function(t,r){var a=e.measureText(s.slice(0,r)).width,u=e.measureText(s.slice(0,r+1)).width,l=i.x-o;l>=a&&u>=l&&(d=n.indexOf(s)+r)})}),d},x=function(e,t){return[e[0]-t.x,e[1]-t.y,e[2],e[3]]},w=function(e,t,i){var r=1.3*t;return{x:e[0]+10,y:e[1]+t+i*r}},y=function(e,t,i){var r=c,n=v(e,r,i),a=s(n,2),o=(a[0],a[1]),u=o.find(function(e){return-1!==e.indexOf(t+1)}),l=void 0;if(u){var h=o.indexOf(u),d=u.indexOf(t+1);u.map(function(e){return i[e-1]}).join("");l={lineNo:h,idxInLine:d,line:u}}return l},S=function(e,t,i,r,n){var s=n.lineNo,a=n.idxInLine,o=n.line,u=o.map(function(e){return r[e-1]}).join(""),l=w(t,i,s),c=l.x,h=l.y,d=e.measureText(u.slice(0,a+1)).width;return{x:c+d,y1:h-i+7,y2:h+7}},E=function(e,t){var i=t.x,r=t.y1,n=t.y2;e.strokeStyle="rgba(255, 255, 255, 0.75)",e.lineWidth=1,e.lineCap="round",e.beginPath(),e.moveTo(i,r),e.lineTo(i,n),e.stroke(),e.strokeStyle=null},C=function(e,t,i,r,n,a){var o=i,u=r;if(o>u){var l=[u,o];o=l[0],u=l[1]}var h=y(e,o,a),d=y(e,u,a);if(h&&d){var f=v(e,c,a),m=s(f,2),p=(m[0],m[1]);if(h.lineNo===d.lineNo){var g=p.find(function(e){return-1!==e.indexOf(o+1)}),x=g.map(function(e){return a[e-1]}).join(""),S=w(t,n,h.lineNo),E=S.x,C=S.y,R=e.measureText(x.slice(0,h.idxInLine+1)).width,b=e.measureText(x.slice(h.idxInLine+1,d.idxInLine)).width;return[{x1:E+R,x2:E+R+b,y1:C-n+7,y2:C+7}]}var I=Array.apply(0,Array(d.lineNo-h.lineNo+1)).map(function(e,t){return t+h.lineNo});return I.map(function(i){var r=w(t,n,i),s=r.x,l=r.y,c=void 0,f=void 0;if(i==h.lineNo){var m=p.find(function(e){return-1!==e.indexOf(o+1)}),v=m.map(function(e){return a[e-1]}).join("");c=e.measureText(v.slice(0,h.idxInLine+1)).width,f=e.measureText(v.slice(h.idxInLine+1)).width}else if(i===d.lineNo){var g=p.find(function(e){return-1!==e.indexOf(u+1)}),x=g.map(function(e){return a[e-1]}).join("");c=0,f=e.measureText(x.slice(0,d.idxInLine)).width}else c=0,f=280;return{x1:s+c,x2:s+c+f,y1:l-n+7,y2:l+7}})}},R=function(e,t,i,r,a,o,u){e.font=i+"px Georgia",e.fillStyle="white";var l=c,h=v(e,l,u),d=s(h,2),f=d[0],m=(d[1],1.3*i);f.forEach(function(t,r){var n=w(o,i,r),s=n.x,a=n.y;e.fillText(t,s,a,o[2]-20)});var p=(Math.min(300,Math.max.apply(Math,n(f.map(function(t){return e.measureText(t).width})))),f.length*m);return o[3]=p+10,r&&(e.lineWidth=2,e.strokeStyle=a?"rgba(87, 205, 255, 0.5)":"#0092d1",e.strokeRect(o[0],o[1],o[2],o[3])),o};e["default"]=o["default"].createClass({displayName:"ImageCanvas",componentWillReceiveProps:function(e){this.redraw(e)},getInitialState:function(){return{text:"“Others have seen what is and asked why. I have seen what could be and asked why not. ” - Pablo Picasso"}},componentDidMount:function(){var e=this,t=this.refs.canvas;f(t),document.addEventListener("keypress",this.handleKeyUp),document.addEventListener("keydown",this.handleKeyDown),this.textRect=[20,20,l-40,l-40],this.cursor=0,setTimeout(this.doRedraw,100),setInterval(function(){e.showCursor=!e.showCursor,setTimeout(e.doRedraw,100)},450)},doRedraw:function(){this.redraw(this.props)},redraw:function(e){e||(e=this.props);var t=this.refs.canvas,i=t.getContext("2d"),r=this.mouseHeld,n=this.showCursor,s=this.textRect,a=(this.cursor,this.state),o=a.text,u=a.isFocused,c=a.isEditing,h=(a.mouseDiff,e.contrast),d=e.fontSize,f=[].slice.apply(document.images).find(function(t){return e.image.url===t.src});if(f){var v=l;p(i,v,f),h&&m(i,v),this.textRect=R(i,v,d,u,r,s,o);var g=void 0;if(c&&this.cursor1&&this.cursor2){var x=C(i,s,this.cursor1,this.cursor2,d,o);if(!x)return;g=!0,x.forEach(function(e){var t=e.x1,r=e.x2,n=e.y1,s=e.y2;i.fillStyle="rgba(87, 205, 255, 0.5)",i.fillRect(t,n,r-t,s-n)})}if(c&&n&&!g){var w=y(i,this.cursor,o);if(w){var b=S(i,s,d,o,w);E(i,b)}}this.props.onRedraw&&this.props.onRedraw(this.refs.canvas.toDataURL("image/jpeg"))}},cancelEditing:function(){this.setState({isEditing:!1}),setTimeout(this.doRedraw,50)},moveCursor:function(e,t){if(t=!1,!t||this.cursor1||this.cursor2||(this.cursor1=this.cursor2=this.cursor),t||(this.cursor1=this.cursor2=null),"left"===e)this.cursor=this.cursor-1,t&&(this.cursor2=this.cursor);else{if("right"!==e)return;this.cursor=this.cursor+1,t&&(this.cursor2=this.cursor)}setTimeout(this.doRedraw,50)},insertOrDeleteChar:function(e){var t=this.state.text,i=void 0;if(this.cursor1||this.cursor2){var r=this.cursor1,n=this.cursor2,s=t.slice(0,r+1),a=t.slice(n);e?(i=s+e+a,this.cursor1=null,this.cursor2=null,this.cursor=r+1):(i=s+a,this.cursor1=null,this.cursor2=null,this.cursor=r)}else{var o=this.cursor,u=t.slice(0,o+1),l=t.slice(o+1);e?(i=u+e+l,this.cursor=o+1):(i=u.slice(0,-1)+l,this.cursor=o-1)}this.setState({text:i}),setTimeout(this.doRedraw,50)},selectAll:function(){this.cursor1=1,this.cursor2=this.state.text.length,this.cursor=this.cursor2,setTimeout(this.doRedraw,150)},handleKeyDown:function(e){if(this.state.isEditing){if(65===e.which&&e.metaKey===!0)return e.preventDefault(),this.selectAll();switch(u[e.which]){case"escape":this.cancelEditing();break;case"arr_left":this.moveCursor("left",e.shiftKey);break;case"arr_right":this.moveCursor("right",e.shiftKey)}}},handleKeyUp:function(e){if("Meta"!==e.keyIdentifier&&"Alt"!==e.keyIdentifier&&"Control"!==e.keyIdentifier&&this.state.isEditing)if("backspace"===u[e.which])this.insertOrDeleteChar();else{var t=String.fromCharCode(e.charCode);e.shiftKey||(t=t.toLowerCase()),this.insertOrDeleteChar(t)}},handleMouseDown:function(e){var t=h(e,this.refs.canvas);this.startPos=t;var i=this.textRect,r=d(t,i);r?(this.mouseHeld=!0,this.state.isFocused&&(this.mouseDown=new Date),this.setState({isFocused:!0}),setTimeout(this.doRedraw,100)):(this.setState({isFocused:!1,isEditing:!1}),setTimeout(this.doRedraw,100))},handleMouseMove:function(e){if(this.mouseHeld){var t=h(e,this.refs.canvas),i={x:this.startPos.x-t.x,y:this.startPos.y-t.y};if(this.state.isFocused&&!this.state.isEditing)this.textRect=x(this.textRect,i),this.setState({mouseDiff:i}),this.startPos=t;else if(this.state.isFocused&&this.state.isEditing){var r=this.startPos,n=t,s=this.refs.canvas,a=s.getContext("2d"),o=this.textRect,u=this.state.text,l=this.props.fontSize,c=g(a,o,r,l,u),d=g(a,o,n,l,u);this.cursor1=c,this.cursor2=d}setTimeout(this.doRedraw,50)}},handleMouseUp:function(e){if(this.mouseDown&&new Date-this.mouseDown<200){var t=this.refs.canvas,i=t.getContext("2d"),r=(this.textRect,this.state.text),n=this.props.fontSize;this.cursor=g(i,this.textRect,this.startPos,n,r)||this.cursor,this.setState({isEditing:!0}),this.cursor1=null,this.cursor2=null,setTimeout(this.doRedraw,50)}this.setState({mouseDiff:null}),this.mouseDown=null,this.mouseHeld=!1,setTimeout(this.doRedraw,50)},render:function(){this.props.image||{};return o["default"].createElement("div",{className:"ImageCanvas"},o["default"].createElement("canvas",{ref:"canvas",width:l,height:l,onMouseDown:this.handleMouseDown,onMouseMove:this.handleMouseMove,onMouseUp:this.handleMouseUp}))}})}),require.register("components/ImagePicker.jsx",function(e,t,i){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(e,"__esModule",{value:!0});var n=t("react"),s=r(n);e["default"]=s["default"].createClass({displayName:"ImagePicker",handleSelect:function(e){this.props.onSelect&&this.props.onSelect(e)},render:function(){var e=this,t=this.props.selected||{};return s["default"].createElement("div",{className:"ImagePicker"},this.props.images.map(function(i){var r=i.url===t.url;return s["default"].createElement("div",{className:"ImagePicker-image",onClick:function(){return e.handleSelect(i)}},s["default"].createElement("img",{className:r?"ImagePicker-image--selected":null,src:i.url,crossOrigin:"anonymous"}))}))}})}),require.register("initialize.js",function(e,t,i){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var n=t("react-dom"),s=r(n),a=t("react"),o=r(a),u=t("components/App"),l=r(u);document.addEventListener("DOMContentLoaded",function(){s["default"].render(o["default"].createElement(l["default"],null),document.querySelector("#app"))})});