{"version":3,"sources":["actions.js","Card.jsx","DownloadButton.jsx","FiltersPicker.jsx","ImageCanvas.jsx","ImagePicker.jsx","SizePicker.jsx","TextPropertiesPicker.jsx","App.jsx","LeftSidebar.jsx","RightSidebar.jsx","initialize.js","reducer.js"],"names":[],"mappings":"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","file":"public/app.js","sourcesContent":["export const setFontSize = (size) => ({\n  type: 'SET_FONT_SIZE',\n  size\n});\n\nexport const setContrast = (contrast) => ({\n  type: 'SET_CONTRAST',\n  contrast\n});\n\nexport const selectImage = (image) => ({\n  type: 'SELECT_IMAGE',\n  image\n});\n\nexport const setSize = (size) => ({\n  type: 'SET_SIZE',\n  size\n});\n\nexport const cacheDrawing = (drawing) => ({\n  type: 'CACHE_DRAWING',\n  drawing\n});\n","import React from 'react';\n\nexport default ({ title, children }) => {\n  return <div className=\"Card\">\n    <div className=\"Card-header\"><h4>{title}</h4></div>\n    {children}\n  </div>\n};\n","import React from 'react';\n\nexport default React.createClass({\n  propTypes: {\n    drawing: React.PropTypes.string\n  },\n\n  handleDownload(e) {\n    const uri = this.props.drawing;\n    const link = e.target;\n    link.href = uri;\n    link.click();\n  },\n\n  render() {\n    return <div>\n      <a className=\"Button\" download=\"pabla.jpg\" target=\"_blank\" onClick={this.handleDownload}>Download</a>\n    </div>;\n  }\n});\n","import React from 'react';\n\nexport default React.createClass({\n  propTypes: {\n    contrast: React.PropTypes.bool.isRequired,\n    onContrastChange: React.PropTypes.func.isRequired\n  },\n\n  updateContrast() {\n    const val = this.refs.contrast.checked;\n    this.props.onContrastChange(val);\n  },\n\n  render() {\n    return <div>\n      <label>\n        <input ref=\"contrast\" checked={this.props.contrast} type=\"checkbox\" onChange={this.updateContrast} /> Contrast\n      </label>\n    </div>;\n  }\n});\n","import React from 'react';\n\nconst keys = {\n  8:  'backspace',\n  27: 'escape',\n  37: 'arr_left',\n  39: 'arr_right'\n};\n\nconst TALL = [500, 750];\nconst SQUARE = [500, 500];\nconst WIDE = [500, 250];\n\nconst CANVAS_WIDTH = 500;\nconst CANVAS_HEIGHT = 250;\nconst MAX_TEXT_WIDTH = CANVAS_WIDTH - 40 - 10;\n\nconst getMousePos = (e, canvas) => {\n  const rect = canvas.getBoundingClientRect();\n  const mousePos = {\n    x: e.clientX - rect.left,\n    y: e.clientY - rect.top\n  };\n  return mousePos;\n};\n\nconst isInRect = (pos, rect) => {\n  return (pos.x >= rect[0] && pos.x <= rect[0] + rect[2]) && (pos.y >= rect[1] && pos.y <= rect[1] + rect[3]);\n}\n\nconst initCanvas = (c, width, height) => {\n  // handle retina w\n  // https://gist.github.com/joubertnel/870190\n  const ctx = c.getContext('2d');\n\n  if (window.devicePixelRatio) {\n    c.width = width * window.devicePixelRatio;\n    c.height = height * window.devicePixelRatio;\n    window.c = c;\n    c.style.width = `${width}px`;\n    c.style.height = `${height}px`;\n    ctx.scale(window.devicePixelRatio, window.devicePixelRatio)\n  }\n};\n\nconst applyContrast = (ctx, canvasWidth, canvasHeight) => {\n  ctx.fillStyle = \"rgba(45, 45, 45, 0.45)\";\n  ctx.fillRect(0, 0, canvasWidth, canvasHeight);\n};\n\nconst drawImage = (ctx, canvasWidth, canvasHeight, img) => {\n  const imgWidth = img.naturalWidth;\n  const imgHeight = img.naturalHeight;\n\n  const origRatio = imgWidth / imgHeight;\n  const canvasRatio = canvasWidth / canvasHeight;\n\n  let zoneWidth, zoneHeight;\n  if (canvasRatio >= origRatio) {\n    zoneWidth = imgWidth;\n    zoneHeight = imgWidth / canvasRatio;\n  } else {\n    zoneWidth = imgHeight * canvasRatio;\n    zoneHeight = imgHeight;\n  }\n\n  const xPad = (imgWidth - zoneWidth) / 2;\n  const yPad = (imgHeight - zoneHeight) / 2;\n\n  ctx.drawImage(img, xPad, yPad, zoneWidth, zoneHeight, 0, 0, canvasWidth, canvasHeight);\n};\n\nconst splitTextInLines = (ctx, maxWidth, text) => {\n  const words = text.split(' ');\n  let lines = [''];\n  let indices = [[]];\n\n  let lastGlobIdx = 0;\n  words.forEach((word, idx) => {\n    const lastIdx = lines.length-1;\n    let lastLine = lines[lastIdx]\n    const newText = lastLine.length === 0 ? word : lastLine + ' ' + word;\n    if (ctx.measureText(newText).width <= maxWidth || lastLine.length === 0) {\n      lines[lastIdx] = newText;\n      const empty = lastLine.length === 0;\n      indices[lastIdx] = indices[lastIdx].concat(word.split('').map((_, i) => lastGlobIdx + 1 + i));\n    } else {\n      indices.push(word.split('').map((_, i) => lastGlobIdx + 1 + i));\n      lines.push(word);\n    }\n    indices[lines.length-1].push(lastGlobIdx + 1 + word.length);\n    lastGlobIdx = lastGlobIdx + 1 + word.length\n  });\n\n  return [lines, indices];\n};\n\nconst findIdxForCursor = (ctx, textRect, cursorAt, fontSize, text) => {\n  ctx.font = `${fontSize}px Georgia`;\n  ctx.fillStyle = \"white\";\n  const maxWidth = MAX_TEXT_WIDTH;\n  const [lines, mapIndices] = splitTextInLines(ctx, maxWidth, text);\n  const spaced = fontSize * 1.3;\n  let cursor;\n  lines.forEach((line, idx) => {\n    const x = textRect[0] + 10;\n    const y = textRect[1] + fontSize + (idx * spaced);\n    // find cursor\n    if (cursorAt && cursorAt.y <= y && cursorAt.y >= y - spaced) {\n      line.split('').forEach((char, idx) => {\n        const wd0 = ctx.measureText(line.slice(0, idx)).width;\n        const wd1 = ctx.measureText(line.slice(0, idx+1)).width;\n        const curX = cursorAt.x - x;\n        if (curX >= wd0 && curX <= wd1) {\n          cursor = text.indexOf(line) + idx;\n        }\n      });\n    }\n  });\n  return cursor;\n};\n\nconst applyMouseDiff = (textRect, mouseDiff) => {\n  return [textRect[0]-mouseDiff.x, textRect[1]-mouseDiff.y, textRect[2], textRect[3]];\n};\n\nconst coordsForLine = (textRect, fontSize, lineNo) => {\n  const spaced = fontSize * 1.3;\n  return { x: textRect[0] + 10, y: textRect[1] + fontSize + (lineNo * spaced) };\n};\n\nconst findPosForCursor = (ctx, cursor, text) => {\n  const maxWidth = MAX_TEXT_WIDTH;\n  const [lines, mapIndices] = splitTextInLines(ctx, maxWidth, text);\n\n  const line = mapIndices.find(line => line.indexOf(cursor+1) !== -1);\n  let pos;\n  if (line) {\n    const lineNo = mapIndices.indexOf(line);\n    const idxInLine = line.indexOf(cursor+1);\n    const lineText = line.map(i => text[i-1]).join('');\n\n    pos = {lineNo, idxInLine, line};\n  }\n  return pos;\n};\n\nconst findCoordsForPos = (ctx, textRect, fontSize, text, pos) => {\n  const {lineNo, idxInLine, line} = pos;\n  const lineText = line.map(i => text[i-1]).join('');\n\n  const {x, y} = coordsForLine(textRect, fontSize, lineNo);\n  const wd1 = ctx.measureText(lineText.slice(0, idxInLine + 1)).width;\n\n  return { x: x+wd1, y1: y-fontSize+7, y2: y+7 };\n};\n\nconst drawCursor = (ctx, coords) => {\n  const {x, y1, y2} = coords;\n\n  ctx.strokeStyle = \"rgba(255, 255, 255, 0.75)\";\n  ctx.lineWidth = 1;\n  ctx.lineCap = 'round';\n  ctx.beginPath();\n  ctx.moveTo(x, y1);\n  ctx.lineTo(x, y2);\n  ctx.stroke();\n  ctx.strokeStyle = null;\n};\n\nconst findRectsForSelection = (ctx, textRect, cursor1, cursor2, fontSize, text) => {\n  let idx1 = cursor1;\n  let idx2 = cursor2;\n  if (idx1 > idx2) {\n    [idx1, idx2] = [idx2, idx1];\n  }\n  const pos1 = findPosForCursor(ctx, idx1, text);\n  const pos2 = findPosForCursor(ctx, idx2, text);\n\n  if (!(pos1 && pos2)) return;\n  const [lines, mapIndices] = splitTextInLines(ctx, MAX_TEXT_WIDTH, text);\n\n  if (pos1.lineNo === pos2.lineNo) {\n    const line = mapIndices.find(line => line.indexOf(idx1+1) !== -1);\n    const lineText = line.map(i => text[i-1]).join('');\n    const {x, y} = coordsForLine(textRect, fontSize, pos1.lineNo);\n    const wd1 = ctx.measureText(lineText.slice(0, pos1.idxInLine + 1)).width;\n    const wd2 = ctx.measureText(lineText.slice(pos1.idxInLine + 1, pos2.idxInLine)).width;\n\n    return [{x1:x+wd1, x2:x+wd1+wd2, y1: y-fontSize+7, y2:y+7 }];\n  } else {\n    const lineNos = Array.apply(0, Array(pos2.lineNo - pos1.lineNo + 1)).map((_, idx) => idx + pos1.lineNo);\n\n    return lineNos.map(lineNo => {\n      const {x, y} = coordsForLine(textRect, fontSize, lineNo);\n\n      let wd1, wd2;\n      if (lineNo == pos1.lineNo) {\n        const line = mapIndices.find(line => line.indexOf(idx1+1) !== -1);\n        const lineText = line.map(i => text[i-1]).join('');\n        wd1 = ctx.measureText(lineText.slice(0, pos1.idxInLine +1)).width;\n        wd2 = ctx.measureText(lineText.slice(pos1.idxInLine + 1)).width;\n      } else if (lineNo === pos2.lineNo) {\n        const line = mapIndices.find(line => line.indexOf(idx2+1) !== -1);\n        const lineText = line.map(i => text[i-1]).join('');\n        wd1 = 0;\n        wd2 = ctx.measureText(lineText.slice(0, pos2.idxInLine)).width;\n      } else {\n        wd1 = 0\n        wd2 = 280;\n      }\n      return {x1:x+wd1, x2:x+wd1+wd2, y1: y-fontSize+7, y2:y+7 };\n    });\n  }\n};\n\nconst addText = (ctx, fontSize, isFocused, mouseHeld, textRect, text) => {\n  ctx.font = `${fontSize}px Georgia`;\n  ctx.fillStyle = \"white\";\n  const maxWidth = MAX_TEXT_WIDTH;\n  const [lines, mapIndices] = splitTextInLines(ctx, maxWidth, text);\n\n  const spaced = fontSize * 1.3;\n  lines.forEach((line, idx) => {\n    const {x, y} = coordsForLine(textRect, fontSize, idx);\n    ctx.fillText(line, x, y, textRect[2]-20);\n  });\n\n  const maxActual = Math.min(300, Math.max(...lines.map(line => ctx.measureText(line).width)));\n  const totalHeight = lines.length * spaced;\n\n  textRect[3] = totalHeight + 10;\n\n  if (isFocused) {\n    ctx.lineWidth = 2;\n    ctx.strokeStyle = !mouseHeld ? \"#0092d1\" : \"rgba(87, 205, 255, 0.5)\";\n    ctx.strokeRect(textRect[0], textRect[1], textRect[2], textRect[3]);\n  }\n  return textRect;\n};\n\n// TODO:\n// wait for image loading\nexport default React.createClass({\n  initSize(size, cb) {\n    const obj = {};\n    [obj.canvasWidth, obj.canvasHeight] = {\n      'tall': TALL,\n      'wide': WIDE,\n      'square': SQUARE\n    }[size];\n    const state = this.state;\n    if (state.canvasWidth === obj.canvasWidth && state.canvasHeight === obj.canvasHeight) {\n    } else {\n      this.setState(obj, cb);\n    }\n  },\n\n  componentWillReceiveProps(nextProps) {\n    this.initSize(nextProps.size, () => {\n      initCanvas(this.refs.canvas, this.state.canvasWidth, this.state.canvasHeight);\n      this.redraw(nextProps);\n    });\n  },\n\n  getInitialState() {\n    return { text: '“Others have seen what is and asked why. I have seen what could be and asked why not. ” - Pablo Picasso' };\n  },\n\n  componentWillMount() {\n    this.initSize(this.props.size || 'square');\n  },\n\n  componentDidMount() {\n    const c = this.refs.canvas;\n    initCanvas(c, this.state.canvasWidth, this.state.canvasHeight);\n    document.addEventListener('keypress', this.handleKeyUp);\n    document.addEventListener('keydown', this.handleKeyDown);\n    this.textRect = [20, 20, this.state.canvasWidth - 40, this.state.canvasHeight - 40];\n    this.cursor = 0;\n    setTimeout(this.doRedraw, 100);\n\n    setInterval(() => {\n      this.showCursor = !this.showCursor;\n      setTimeout(this.doRedraw, 100)\n    }, 450);\n  },\n\n  doRedraw() {\n    this.redraw(this.props);\n  },\n\n  redraw(nextProps) {\n    if (!nextProps) nextProps = this.props;\n\n    const canvas = this.refs.canvas;\n    const ctx = canvas.getContext('2d');\n\n    const {mouseHeld, showCursor, textRect, cursor} = this;\n    const {text, isFocused, isEditing, mouseDiff} = this.state;\n\n    const hasContrast = nextProps.contrast;\n    const fontSize = nextProps.fontSize;\n\n    const img = [].slice.apply(document.images).find(i => nextProps.image.url === i.src);\n    if (!img) return;\n\n    drawImage(ctx, this.state.canvasWidth, this.state.canvasHeight, img);\n    if (hasContrast) applyContrast(ctx, this.state.canvasWidth, this.state.canvasHeight)\n    this.textRect = addText(ctx, fontSize, isFocused, mouseHeld, textRect,  text);\n    let setCursor;\n    if (isEditing && this.cursor1 && this.cursor2) {\n      const rects = findRectsForSelection(ctx, textRect, this.cursor1, this.cursor2, fontSize, text);\n      if (!rects) return;\n\n      setCursor = true;\n      rects.forEach(rect => {\n        const {x1,x2,y1,y2} = rect;\n        ctx.fillStyle = \"rgba(87, 205, 255, 0.5)\";\n        ctx.fillRect(x1,y1,x2-x1,y2-y1);\n      });\n    }\n    if (isEditing && showCursor && !setCursor) {\n      const pos = findPosForCursor(ctx, this.cursor, text);\n      if (pos) {\n        const coords = findCoordsForPos(ctx, textRect, fontSize, text, pos);\n        drawCursor(ctx, coords);\n      }\n    }\n\n    this.props.onRedraw && this.props.onRedraw(this.refs.canvas.toDataURL('image/jpeg'));\n  },\n\n  cancelEditing() {\n    this.setState({ isEditing: false });\n    setTimeout(this.doRedraw, 50);\n  },\n\n  moveCursor(dir, shift) {\n    // TODO: implement shift-selection\n    shift = false;\n\n    if (shift && !this.cursor1 && !this.cursor2) {\n      this.cursor1 = this.cursor2 = this.cursor;\n    }\n\n    if (!shift) {\n      this.cursor1 = this.cursor2 = null;\n    }\n\n    if (dir === 'left') {\n      this.cursor = this.cursor - 1;\n      if (shift) {\n        this.cursor2 = this.cursor;\n      }\n    } else if (dir === 'right') {\n      this.cursor = this.cursor + 1;\n      if (shift) {\n        this.cursor2 = this.cursor;\n      }\n    } else {\n      return;\n    }\n\n    setTimeout(this.doRedraw, 50);\n  },\n\n  insertOrDeleteChar(char) {\n    const currText = this.state.text;\n    let newText;\n    if (!this.cursor1 && !this.cursor2) {\n      const globalCurrIdx = this.cursor;\n      const beforeCurr = currText.slice(0, globalCurrIdx + 1);\n      const afterCurr = currText.slice(globalCurrIdx+1);\n      if (!char) {\n        newText = beforeCurr.slice(0, -1) + afterCurr;\n        this.cursor = globalCurrIdx - 1;\n      } else {\n        newText = beforeCurr + char + afterCurr;\n        this.cursor = globalCurrIdx + 1;\n      }\n    } else {\n      const idx1 = this.cursor1;\n      const idx2 = this.cursor2;\n\n      const beforeCurr = currText.slice(0, idx1 + 1);\n      const afterCurr = currText.slice(idx2);\n      if (!char) {\n        newText = beforeCurr + afterCurr;\n        this.cursor1 = null;\n        this.cursor2 = null;\n        this.cursor = idx1;\n      } else {\n        newText = beforeCurr + char + afterCurr;\n        this.cursor1 = null;\n        this.cursor2 = null;\n        this.cursor = idx1 + 1;\n      }\n    }\n\n    this.setState({ text: newText });\n    setTimeout(this.doRedraw, 50);\n  },\n\n  selectAll() {\n    // doesn't quite select the first char\n    this.cursor1 = 1;\n    this.cursor2 = this.state.text.length;\n    this.cursor = this.cursor2;\n    setTimeout(this.doRedraw, 150);\n  },\n\n  handleKeyDown(e) {\n    if (this.state.isEditing) {\n      if (e.which === 65 && e.metaKey === true) {\n        e.preventDefault();\n        return this.selectAll();\n\n      }\n      switch (keys[e.which]) {\n        case 'escape':\n          this.cancelEditing();\n          break;\n        case 'arr_left':\n          this.moveCursor('left', e.shiftKey);\n          break;\n        case 'arr_right':\n          this.moveCursor('right', e.shiftKey);\n          break;\n      }\n    }\n  },\n\n  handleKeyUp(e) {\n    if (e.keyIdentifier === 'Meta' || e.keyIdentifier === 'Alt' || e.keyIdentifier === 'Control') return;\n\n    if (this.state.isEditing) {\n      if (keys[e.which] === 'backspace') {\n        this.insertOrDeleteChar();\n      } else {\n        let char = String.fromCharCode(e.charCode);\n        if (!e.shiftKey) char = char.toLowerCase();\n        this.insertOrDeleteChar(char);\n      }\n    }\n  },\n\n  handleMouseDown(e) {\n    const mousePos = getMousePos(e, this.refs.canvas);\n    this.startPos = mousePos;\n\n    const textRect = this.textRect;\n    const isInTextRect = isInRect(mousePos, textRect);\n\n    if (isInTextRect) {\n      this.mouseHeld = true;\n      if (this.state.isFocused) {\n        this.mouseDown = new Date;\n      }\n      this.setState({ isFocused: true });\n      setTimeout(this.doRedraw, 100);\n    } else {\n      this.setState({ isFocused: false, isEditing: false });\n      setTimeout(this.doRedraw, 100);\n    }\n  },\n\n  handleMouseMove(e) {\n    if (this.mouseHeld) {\n      // move\n\n      const mousePos = getMousePos(e, this.refs.canvas);\n\n      const mouseDiff = {\n        x: this.startPos.x - mousePos.x,\n        y: this.startPos.y - mousePos.y\n      };\n\n      if (this.state.isFocused && !this.state.isEditing) {\n        this.textRect = applyMouseDiff(this.textRect, mouseDiff);\n        this.setState({ mouseDiff });\n        this.startPos = mousePos;\n      } else if (this.state.isFocused && this.state.isEditing) {\n        const cursor1 = this.startPos;\n        const cursor2 = mousePos;\n\n\n        const canvas = this.refs.canvas;\n        const ctx = canvas.getContext('2d');\n        const {textRect} = this;\n        const {text} = this.state;\n        const fontSize = this.props.fontSize;\n        let idx1 = findIdxForCursor(ctx, textRect, cursor1, fontSize, text);\n        let idx2 = findIdxForCursor(ctx, textRect, cursor2, fontSize, text);\n        this.cursor1 = idx1;\n        this.cursor2 = idx2;\n      }\n\n      setTimeout(this.doRedraw, 50);\n    }\n  },\n\n  handleMouseUp(e) {\n    if (this.mouseDown) {\n      if ((new Date - this.mouseDown) < 200) {\n        const canvas = this.refs.canvas;\n        const ctx = canvas.getContext('2d');\n        const {textRect} = this;\n        const {text} = this.state;\n        const fontSize = this.props.fontSize;\n        this.cursor = findIdxForCursor(ctx, this.textRect, this.startPos, fontSize, text) || this.cursor;\n        this.setState({ isEditing: true });\n        this.cursor1 = null;\n        this.cursor2 = null;\n\n        setTimeout(this.doRedraw, 50);\n      }\n    }\n    this.setState({ mouseDiff: null });\n    this.mouseDown = null;\n    this.mouseHeld = false;\n    setTimeout(this.doRedraw, 50);\n  },\n\n  render() {\n    const image = this.props.image || {};\n    return <div className=\"ImageCanvas\">\n      <canvas ref=\"canvas\" width={this.state.canvasWidth} height={this.state.canvasHeight} onMouseDown={this.handleMouseDown} onMouseMove={this.handleMouseMove} onMouseUp={this.handleMouseUp} />\n    </div>\n  }\n});\n","import React from 'react';\n\nexport default React.createClass({\n  propTypes: {\n    images: React.PropTypes.arrayOf(React.PropTypes.shape({ url: React.PropTypes.string })).isRequired,\n    selected: React.PropTypes.shape({ url: React.PropTypes.string }),\n    onSelect: React.PropTypes.func\n  },\n\n  handleSelect(image) {\n    this.props.onSelect && this.props.onSelect(image);\n  },\n\n  render() {\n    const selected = this.props.selected || {};\n    return <div className=\"ImagePicker\">\n      {this.props.images.map(image => {\n        const sel = image.url === selected.url;\n        const className = 'ImagePicker-image' + (sel ? ' ImagePicker-image--selected' : '');\n        return <div className={className} onClick={() => this.handleSelect(image)} key={image.url}>\n          <div className=\"ImagePicker-image-wrapper\"><img src={image.url} crossOrigin=\"anonymous\" /></div>\n        </div>\n      })}\n    </div>;\n  }\n});\n","import React from 'react';\n\nconst SizeItem = ({ name, code, currentCode, onSelect }) => {\n  const onClick = (e) => {\n    e.preventDefault();\n    onSelect(code);\n  };\n  const className = `SizePicker-size SizePicker-size--${code}` + (code === currentCode ? ' SizePicker-size--selected' : '');\n\n  return <div className={className} onClick={onClick}>\n    <div className=\"SizePicker-size-wrapper\">\n      {name}\n    </div>\n  </div>\n};\n\nexport default React.createClass({\n  render() {\n    const size = this.props.size;\n\n    return <div className=\"SizePicker\">\n      <SizeItem name=\"Tall\" code=\"tall\" currentCode={size} onSelect={this.props.onSizeSelect} />\n      <SizeItem name=\"Square\" code=\"square\" currentCode={size} onSelect={this.props.onSizeSelect} />\n      <SizeItem name=\"Wide\" code=\"wide\" currentCode={size} onSelect={this.props.onSizeSelect} />\n    </div>;\n  }\n});\n","import React from 'react';\n\nexport default React.createClass({\n  propTypes: {\n    fontSize: React.PropTypes.number.isRequired,\n    onFontSizeChange: React.PropTypes.func.isRequired\n  },\n\n  updateFontSize() {\n    const val = parseInt(this.refs.fontSize.value, 10);\n    this.props.onFontSizeChange(val);\n  },\n\n  render() {\n    return <div>\n      Font size:\n      <select ref=\"fontSize\" value={this.props.fontSize} onChange={this.updateFontSize}>\n        {[8, 10, 12, 14, 16, 18, 20, 22, 26, 32, 36, 42, 48, 54].map(s => <option key={s} value={s}>{s}</option>)}\n      </select>\n    </div>;\n  }\n});\n","import React from 'react';\nimport {connect} from 'react-redux';\nimport {cacheDrawing} from 'actions';\n\nimport LeftSidebar from './LeftSidebar';\nimport RightSidebar from './RightSidebar';\nimport ImageCanvas from 'components/ImageCanvas';\n\nconst App = React.createClass({\n  updateDrawnImage(data) {\n    if (this.props.drawing === data) return;\n    this.props.onCacheDrawing(data);\n  },\n\n  render() {\n    return (\n      <div className=\"Container\">\n        <LeftSidebar />\n        <div className=\"Main\">\n          <h4 className=\"Main-subtitle\">Canvas</h4>\n          <ImageCanvas image={this.props.selected} fontSize={this.props.fontSize} contrast={this.props.contrast} size={this.props.size} onRedraw={this.updateDrawnImage} />\n        </div>\n        <RightSidebar />\n      </div>\n    );\n  }\n});\n\nconst mapStateToProps = (state) => ({\n  fontSize: state.fontSize,\n  contrast: state.contrast,\n  size: state.size,\n  selected: state.selectedImage,\n  drawing: state.drawing\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n  onCacheDrawing(drawing) {\n    dispatch(cacheDrawing(drawing));\n  }\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n","import React from 'react';\nimport {connect} from 'react-redux';\nimport {selectImage} from 'actions';\n\nimport Card from 'components/Card';\nimport ImagePicker from 'components/ImagePicker';\n\nconst LeftSidebar = ({ availableImages, selectedImage, onSelectImage }) => {\n  return <div className=\"Sidebar\">\n    <Card title=\"Images\">\n      <ImagePicker images={availableImages} selected={selectedImage} onSelect={onSelectImage} />\n    </Card>\n  </div>;\n};\n\nconst mapStateToProps = (state) => ({\n  availableImages: state.availableImages,\n  selectedImage: state.selectedImage\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n  onSelectImage(image) {\n    dispatch(selectImage(image));\n  }\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(LeftSidebar);\n","import React from 'react';\nimport {connect} from 'react-redux';\nimport {setContrast, setFontSize, setSize} from 'actions';\n\nimport Card from 'components/Card';\nimport FiltersPicker from 'components/FiltersPicker';\nimport TextPropertiesPicker from 'components/TextPropertiesPicker';\nimport SizePicker from 'components/SizePicker';\nimport DownloadButton from 'components/DownloadButton';\n\nconst RightSidebar = ({ drawing, contrast, onContrastChange, fontSize, onFontSizeChange, size, onSizeSelect }) => {\n  return <div className=\"Sidebar\">\n    <Card title=\"Sizes\">\n      <SizePicker size={size} onSizeSelect={onSizeSelect} />\n    </Card>\n    <Card title=\"Filters\">\n      <FiltersPicker contrast={contrast} onContrastChange={onContrastChange} />\n    </Card>\n    <Card title=\"Text\">\n      <TextPropertiesPicker fontSize={fontSize} onFontSizeChange={onFontSizeChange} />\n    </Card>\n    <DownloadButton drawing={drawing} />\n    <p className=\"Credit\">\n      Made by <a href=\"http://goshakkk.name\">Gosha Arinich</a>. <a href=\"https://github.com/goshakkk/pabla\">Repo</a>.\n    </p>\n  </div>;\n};\n\nconst mapStateToProps = (state) => ({\n  fontSize: state.fontSize,\n  contrast: state.contrast,\n  size: state.size,\n  drawing: state.drawing\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n  onFontSizeChange(size) {\n    dispatch(setFontSize(size));\n  },\n\n  onContrastChange(contrast) {\n    dispatch(setContrast(contrast));\n  },\n\n  onSizeSelect(size) {\n    dispatch(setSize(size));\n  }\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(RightSidebar);\n","import ReactDOM from 'react-dom';\nimport React from 'react';\nimport {createStore} from 'redux';\nimport {Provider} from 'react-redux';\n\nimport reducer from 'reducer';\nimport App from 'container/App';\n\nconst store = createStore(reducer);\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  ReactDOM.render(\n    <Provider store={store}>\n      <App />\n    </Provider>,\n    document.querySelector('#app')\n  );\n});\n","const images = [\n  { url: 'https://images.unsplash.com/photo-1458640904116-093b74971de9?fm=jpg' },\n  { url: 'https://images.unsplash.com/photo-1453227588063-bb302b62f50b?fm=jpg' },\n  { url: 'https://images.unsplash.com/photo-1451906278231-17b8ff0a8880?fm=jpg' },\n  { url: 'https://images.unsplash.com/photo-1447969025943-8219c41ea47a?fm=jpg' },\n  { url: 'https://images.unsplash.com/photo-1421749810611-438cc492b581?fm=jpg' },\n  { url: 'https://images.unsplash.com/photo-1449960238630-7e720e630019?fm=jpg' },\n  { url: 'https://images.unsplash.com/photo-1433190152045-5a94184895da?fm=jpg' }\n];\n\nconst initialState = {\n  fontSize: 32,\n  contrast: true,\n  availableImages: images,\n  selectedImage: images[0],\n  drawing: null,\n  size: 'square'\n};\n\nexport default function(state = initialState, action) {\n  switch (action.type) {\n    case 'SET_FONT_SIZE':\n      return Object.assign({}, state, { fontSize: action.size });\n    case 'SET_CONTRAST':\n      return Object.assign({}, state, { contrast: action.contrast });\n    case 'SELECT_IMAGE':\n      return Object.assign({}, state, { selectedImage: action.image });\n    case 'SET_SIZE':\n      return Object.assign({}, state, { size: action.size });\n    case 'CACHE_DRAWING':\n      return Object.assign({}, state, { drawing: action.drawing });\n    default:\n      return state;\n  }\n}\n"]}